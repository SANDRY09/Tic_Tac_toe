import tkinter as tk
from tkinter import messagebox

# --- Konfigurasi Game Global ---
current_player = "X"
board = ["" for _ in range(9)]
buttons = []
game_active = True
score_x = 0
score_o = 0




# Warna kustom
PLAYER_X_COLOR = "pink"
PLAYER_O_COLOR = "purple"
WIN_BG_COLOR = "lightgreen"

def handle_click(index):
    """Menangani klik pada tombol papan."""
    global current_player, game_active, score_x, score_o

    if board[index] == "" and game_active:
        # Update board logic and GUI
        board[index] = current_player
        color = PLAYER_X_COLOR if current_player == "X" else PLAYER_O_COLOR
        buttons[index].config(text=current_player, state=tk.DISABLED, disabledforeground=color)
        
        if check_win():
            messagebox.showinfo("Game Over", f"Pemain {current_player} Menang!")
            game_active = False
            highlight_winner()
            if current_player == "X":
                score_x += 1
            else:
                score_o += 1
            update_score_labels()
        elif check_draw():
            messagebox.showinfo("Game Over", "Permainan Seri!")
            game_active = False
        
        # Switch player only if game is active
        if game_active:
            current_player = "O" if current_player == "X" else "X"
            label_status.config(text=f"Giliran Pemain {current_player}")

def check_win():
    """Memeriksa semua kemungkinan kombinasi kemenangan."""
    global winning_combo # Simpan kombinasi pemenang untuk highlight
    winning_combinations = [
        (0, 1, 2), (3, 4, 5), (6, 7, 8),
        (0, 3, 6), (1, 4, 7), (2, 5, 8),
        (0, 4, 8), (2, 4, 6)
    ]
    for combo in winning_combinations:
        if board[combo[0]] == board[combo[1]] == board[combo[2]] != "":
            winning_combo = combo
            return True
    return False

def highlight_winner():
    """Memberi highlight pada 3 tombol pemenang."""
    for i in winning_combo:
        buttons[i].config(bg=WIN_BG_COLOR)

def check_draw():
    """Memeriksa apakah papan penuh (seri)."""
    return "" not in board

def update_score_labels():
    """Memperbarui tampilan skor di GUI."""
    label_score_x.config(text=f"Skor X: {score_x}")
    label_score_o.config(text=f"Skor O: {score_o}")

def reset_game():
    """Mereset ulang papan untuk permainan baru, tapi menjaga skor."""
    global current_player, board, game_active
    current_player = "X"
    board = ["" for _ in range(9)]
    game_active = True
    label_status.config(text=f"Giliran Pemain {current_player}")
    for button in buttons:
        button.config(text="", state=tk.NORMAL, bg='SystemButtonFace')

# --- Setup GUI Tkinter ---

root = tk.Tk()
root.title("Tic Tac Toe Modern (Python Tkinter)")
root.resizable(False, False)

# --- Area Status dan Skor ---
status_frame = tk.Frame(root)
status_frame.grid(row=0, column=0, columnspan=3, pady=10)

label_score_x = tk.Label(status_frame, text=f"Skor X: {score_x}", font=("Helvetica", 12), fg=PLAYER_X_COLOR)
label_score_x.pack(side=tk.LEFT, padx=20)

label_status = tk.Label(status_frame, text=f"Giliran Pemain {current_player}", font=("Helvetica", 16, "bold"))
label_status.pack(side=tk.LEFT, padx=20)

label_score_o = tk.Label(status_frame, text=f"Skor O: {score_o}", font=("Helvetica", 12), fg=PLAYER_O_COLOR)
label_score_o.pack(side=tk.LEFT, padx=20)


# --- Frame untuk Papan Permainan ---
game_frame = tk.Frame(root)
game_frame.grid(row=1, column=0, columnspan=3)

# Membuat 9 tombol untuk papan
for i in range(9):
    button = tk.Button(game_frame, 
                       text="", 
                       font=("Helvetica", 32, "bold"), 
                       height=1, 
                       width=3, 
                       command=lambda index=i: handle_click(index))
    # Menggunakan relief flat untuk tampilan modern
    button.grid(row=i//3, column=i%3, padx=3, pady=3)
    buttons.append(button)

# Tombol Reset Game
reset_button = tk.Button(root, text="Mulai Ronde Baru", command=reset_game, font=("Helvetica", 12))
reset_button.grid(row=2, column=0, columnspan=3, pady=10)

# Memulai loop utama GUI
root.mainloop()
